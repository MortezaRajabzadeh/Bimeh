# Ø³ÛŒØ³ØªÙ… Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒÙ‡Ø§

## ðŸ“‹ Ø®Ù„Ø§ØµÙ‡

Ø³ÛŒØ³ØªÙ… Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ø§ÙˆÙ„ÙˆÛŒØª Ø¨ÛŒÙ…Ù‡ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø§Ø² `spatie/laravel-query-builder` Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø³ÙˆØ±Øªâ€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

## ðŸŽ¯ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

### 1. Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² ÙˆØ²Ù†ÛŒ
- Ù‡Ø± Ù…Ø¹ÛŒØ§Ø± Ø¯Ø§Ø±Ø§ÛŒ ÙˆØ²Ù† Ù…Ø´Ø®ØµÛŒ Ø§Ø³Øª (0-10)
- Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹ ÙˆØ²Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ù…Ø«Ø§Ù„: Ø²Ù† Ø³Ø±Ù¾Ø±Ø³Øª (ÙˆØ²Ù† 10) + Ø¨ÛŒÚ©Ø§Ø±ÛŒ (ÙˆØ²Ù† 2) = Ø§Ù…ØªÛŒØ§Ø² 12

### 2. ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø®Ø§Øµ
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø·Ø±Ø­â€ŒÙ‡Ø§ÛŒ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø§Ù…ØªÛŒØ§Ø²
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² Ø­Ø¯Ø§Ù‚Ù„/Ø­Ø¯Ø§Ú©Ø«Ø±

### 3. Ø³ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
- Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² ÙˆØ²Ù†ÛŒ
- Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§
- Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² Ø§ÙˆÙ„ÙˆÛŒØª (Ø´Ø§Ù…Ù„ Ø¹ÙˆØ§Ù…Ù„ Ø§Ø¶Ø§ÙÛŒ)

## ðŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

#### 1. ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ
```php
app/QueryFilters/FamilyRankingFilter.php
```
- `ranking`: ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
- `ranking_scheme`: ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø·Ø±Ø­ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- `ranking_score_min/max`: ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø§Ù…ØªÛŒØ§Ø²
- `ranking_score_range`: ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø­Ø¯ÙˆØ¯Ù‡

#### 2. Ø³ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ
```php
app/QuerySorts/FamilyRankingSort.php
```
- `weighted_rank`: Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² ÙˆØ²Ù†ÛŒ
- `criteria_count`: Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§
- `priority_score`: Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø² Ø§ÙˆÙ„ÙˆÛŒØª

#### 3. Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Livewire
```php
app/Livewire/Insurance/FamiliesApproval.php
```
- Ù…ØªØ¯ `applyRankingFilter()`: Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ± Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- Ù…ØªØ¯ `calculateDisplayScore()`: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ù†Ù…Ø§ÛŒØ´
- Ù…ØªØ¯ `sortBy()`: Ø³ÙˆØ±Øª Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ

## ðŸ“Š Ù†Ø­ÙˆÙ‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø²

### Ø§Ù…ØªÛŒØ§Ø² ÙˆØ²Ù†ÛŒ Ø³Ø§Ø¯Ù‡
```sql
SELECT SUM(rs.weight)
FROM rank_settings rs
WHERE JSON_CONTAINS(families.acceptance_criteria, CAST(rs.id AS JSON))
AND rs.is_active = 1
```

### Ø§Ù…ØªÛŒØ§Ø² Ø§ÙˆÙ„ÙˆÛŒØª (Ù¾ÛŒØ´Ø±ÙØªÙ‡)
```sql
(
    Ø§Ù…ØªÛŒØ§Ø² ÙˆØ²Ù†ÛŒ Ã— 10
) + (
    ØªØ¹Ø¯Ø§Ø¯ Ø§Ø¹Ø¶Ø§ Ã— 2
) + (
    Ø§Ù…ØªÛŒØ§Ø² Ø³Ø±Ù¾Ø±Ø³Øª Ø²Ù† (50)
) + (
    Ø§Ù…ØªÛŒØ§Ø² ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª (10-20)
)
```

## ðŸŽ›ï¸ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ

### 1. Ù…ÙˆØ¯Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±ØªØ¨Ù‡
- Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ ÙØ¹Ø§Ù„
- ØªÙ†Ø¸ÛŒÙ… ÙˆØ²Ù†â€ŒÙ‡Ø§
- Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ± ÛŒØ§ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡

### 2. Ø¬Ø¯ÙˆÙ„ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒÙ‡Ø§
- Ù†Ù…Ø§ÛŒØ´ Ø§Ù…ØªÛŒØ§Ø² Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- Ø³ÙˆØ±Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø²
- Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø·Ø­ Ø§Ù…ØªÛŒØ§Ø²

### 3. ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø§Ù…ØªÛŒØ§Ø²
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø®Ø§Øµ

## ðŸ”§ API Endpoints

### ÙÛŒÙ„ØªØ±Ù‡Ø§
```
GET /families?filter[ranking]=1,2,3
GET /families?filter[ranking_scheme]=1
GET /families?filter[ranking_score_min]=10
GET /families?filter[ranking_score_max]=50
GET /families?filter[ranking_score_range]=10,50
```

### Ø³ÙˆØ±Øªâ€ŒÙ‡Ø§
```
GET /families?sort=weighted_rank
GET /families?sort=-weighted_rank
GET /families?sort=criteria_count
GET /families?sort=priority_score
```

## ðŸ§ª ØªØ³Øªâ€ŒÙ‡Ø§

### ÙØ§ÛŒÙ„ ØªØ³Øª
```php
tests/Feature/FamilyRankingTest.php
```

### ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯
- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- Ø³ÙˆØ±Øª Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø²
- ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø·Ø±Ø­ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ø§ÙˆÙ„ÙˆÛŒØª
- Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§

## ðŸ“ˆ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ

### Ù…Ø«Ø§Ù„ 1: Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø¨Ø§ Ø²Ù† Ø³Ø±Ù¾Ø±Ø³Øª
- Ù…Ø¹ÛŒØ§Ø±: Ø²Ù† Ø³Ø±Ù¾Ø±Ø³Øª (ÙˆØ²Ù† 10)
- Ø§Ù…ØªÛŒØ§Ø²: 10
- Ø§ÙˆÙ„ÙˆÛŒØª: Ø¨Ø§Ù„Ø§

### Ù…Ø«Ø§Ù„ 2: Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø¨Ø§ Ø¨ÛŒÚ©Ø§Ø±ÛŒ
- Ù…Ø¹ÛŒØ§Ø±: Ø¨ÛŒÚ©Ø§Ø±ÛŒ (ÙˆØ²Ù† 2)
- Ø§Ù…ØªÛŒØ§Ø²: 2
- Ø§ÙˆÙ„ÙˆÛŒØª: Ù…ØªÙˆØ³Ø·

### Ù…Ø«Ø§Ù„ 3: Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø¨Ø§ Ú†Ù†Ø¯ÛŒÙ† Ù…Ø¹ÛŒØ§Ø±
- Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§: Ø²Ù† Ø³Ø±Ù¾Ø±Ø³Øª (10) + Ø¨ÛŒÚ©Ø§Ø±ÛŒ (2) + Ø¨ÛŒÙ…Ø§Ø±ÛŒ Ø®Ø§Øµ (5)
- Ø§Ù…ØªÛŒØ§Ø²: 17
- Ø§ÙˆÙ„ÙˆÛŒØª: Ø®ÛŒÙ„ÛŒ Ø¨Ø§Ù„Ø§

## ðŸ”„ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒâ€ŒÙ‡Ø§

### Ù†Ø³Ø®Ù‡ 1.0
- Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø³ÛŒØ³ØªÙ… Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
- ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø³ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
- Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…ÙˆØ¯Ø§Ù„

### Ù†Ø³Ø®Ù‡ 1.1 (Ø¢ÛŒÙ†Ø¯Ù‡)
- Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡â€ŒØªØ±
- ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ†
- Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø§ÙˆÙ„ÙˆÛŒØª

## ðŸš€ Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ

### Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§
```bash
composer require spatie/laravel-query-builder
```

### ØªÙ†Ø¸ÛŒÙ…Ø§Øª
1. Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² ÙˆØ¬ÙˆØ¯ Ø¬Ø¯ÙˆÙ„ `rank_settings`
2. ØªÙ†Ø¸ÛŒÙ… Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
3. ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ú©Ø´ Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ±

### Ø§Ø³ØªÙØ§Ø¯Ù‡
```php
// Ø¯Ø± Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Livewire
$this->applyRankingFilter([1, 2, 3]); // Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ 1ØŒ 2ØŒ 3

// Ø¯Ø± API
$families = QueryBuilder::for(Family::class)
    ->allowedFilters(['ranking', 'ranking_scheme'])
    ->allowedSorts(['weighted_rank', 'priority_score'])
    ->get();
```

## ðŸ“ž Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ

Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ§Ù„Ø§Øª Ùˆ Ù…Ø´Ú©Ù„Ø§Øª:
- Ø§ÛŒØ¬Ø§Ø¯ Issue Ø¯Ø± GitHub
- ØªÙ…Ø§Ø³ Ø¨Ø§ ØªÛŒÙ… ØªÙˆØ³Ø¹Ù‡
- Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø³ØªÙ†Ø¯Ø§Øª API 